{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\n\nexport const getImages = async (searchCategory, page) => {\n  const BASE_URL = 'https://pixabay.com/api/';\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: '44070082-fd53ee46a47d37a3fc9d7b56d',\n        q: searchCategory,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        per_page: '15',\n        page: page,\n      },\n    });\n    return response.data;\n  } catch (error) {\n    throw new Error(error.message);\n  }\n};\n","export const GalleryItem = images => {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width = \"360\"\n              height = \"200\"\n            />\n            <ul class=\"image-info\">\n              <li class=\"item-info\">Likes <span>${likes}</span></li>\n              <li class=\"item-info\">Views <span>${views}</span></li>\n              <li class=\"item-info\">Comments <span>${comments}</span></li>\n              <li class=\"item-info\">Downloads <span>${downloads}</span></li>\n            </ul>\n          </a>\n        </li>\n    `\n    )\n    .join('');\n};\n","'use strict';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getImages } from './js/pixabay-api.js';\nimport { GalleryItem } from './js/render-functions.js';\n\nconst queryEl = {\n  galleryEl: document.querySelector(`.gallery-list`),\n  galleryItem: document.querySelector(`.gallery-item`),\n  searchForm: document.querySelector(`.form`),\n  searchBtn: document.querySelector('.search-btn'),\n  loader: document.querySelector(`.loader`),\n  loadBtn: document.querySelector(`.load-more-btn`),\n};\n\nlet page = 1;\nlet totalHits = 0;\nlet globalSearchCategory;\n\nqueryEl.searchForm.addEventListener(`submit`, galleryOn);\nqueryEl.loadBtn.addEventListener('click', handleLoad);\n\nasync function galleryOn(e) {\n  e.preventDefault();\n  loaderShow();\n\n  queryEl.galleryEl.innerHTML = '';\n\n  const searchCategory = e.target.elements.search.value.trim();\n  globalSearchCategory = searchCategory;\n  if (!searchCategory) {\n    queryEl.galleryEl.innerHTML = '';\n    e.target.reset();\n    return;\n  }\n\n  try {\n    const imagesData = await getImages(searchCategory, (page = 1));\n    if (imagesData.hits.length) {\n      queryEl.galleryEl.innerHTML = GalleryItem(imagesData.hits);\n      lightbox.refresh();\n      totalHits = Math.ceil(imagesData.totalHits / 15);\n      if (page < totalHits) {\n        visibilityLoad();\n      } else {\n        hiddenLoad();\n        iziToast.error({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          backgroundColor: '#EF4040',\n          theme: 'dark',\n          maxWidth: 354,\n          messageSize: '16',\n        });\n      }\n    } else {\n      hiddenLoad();\n      throw new Error(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n    }\n  } catch (error) {\n    iziToast.error({\n      message: error.message,\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      theme: 'dark',\n      iconUrl: octagon,\n      maxWidth: 354,\n      messageSize: '16',\n    });\n  } finally {\n    loaderHide();\n    e.target.reset();\n  }\n}\n\nasync function handleLoad() {\n  page += 1;\n  hiddenLoad();\n  loaderShow();\n\n  try {\n    const imagesData = await getImages(globalSearchCategory, page);\n    if (imagesData.hits.length) {\n      queryEl.galleryEl.insertAdjacentHTML(\n        'beforeend',\n        GalleryItem(imagesData.hits)\n      );\n      lightbox.refresh();\n\n      if (queryEl.galleryEl) {\n        smoothScrollByTwoCardHeights();\n      } else {\n        console.error(\"Element 'galleryItem' is not found.\");\n      }\n      totalHits = Math.ceil(imagesData.totalHits / 15);\n      if (page < totalHits) {\n        visibilityLoad();\n      }\n    }\n  } catch (error) {\n    hiddenLoad();\n    iziToast.error({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      backgroundColor: '#EF4040',\n      theme: 'dark',\n      maxWidth: 354,\n      messageSize: '16',\n    });\n  } finally {\n    loaderHide();\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery-link', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  className: 'modal-image',\n});\n\nfunction loaderShow() {\n  queryEl.loader.style.display = 'inline-block';\n}\n\nfunction loaderHide() {\n  queryEl.loader.style.display = 'none';\n}\n\nfunction visibilityLoad() {\n  queryEl.loadBtn.classList.remove('hidden');\n}\n\nfunction hiddenLoad() {\n  queryEl.loadBtn.classList.add('hidden');\n}\n\nfunction getCardHeight() {\n  const card = queryEl.galleryEl.firstChild;\n  const cardRect = card.getBoundingClientRect();\n  return cardRect.height;\n}\n\nfunction smoothScrollByTwoCardHeights() {\n  const cardHeight = getCardHeight();\n  window.scrollBy({\n    left: 0,\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["getImages","searchCategory","page","BASE_URL","axios","error","GalleryItem","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","queryEl","totalHits","globalSearchCategory","galleryOn","handleLoad","loaderShow","imagesData","lightbox","visibilityLoad","hiddenLoad","iziToast","loaderHide","smoothScrollByTwoCardHeights","SimpleLightbox","getCardHeight","cardHeight"],"mappings":"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"}